<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Instrument Drivers &mdash; NOMAD-CAMELS  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/CAMELS.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Uploading a new NOMAD-CAMELS version to PyPI" href="pypi_upload.html" />
    <link rel="prev" title="Changing the CAMELS Installer" href="camels_installer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            NOMAD-CAMELS
              <img src="../../_static/camels_horizontal.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/quick_start.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users_guide.html">User's Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../instruments/instruments.html">Instruments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="programmers_guide.html">Programmer's Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="camels_installer.html">CAMELS Installer</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Instrument Drivers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#local-instrument-drivers">Local Instrument Drivers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#file-templates">File Templates</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#advanced-driver-information">Advanced Driver Information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#writing-new-instrument-drivers-for-pypi">Writing New Instrument Drivers for PyPi</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#folder-structure">1. Folder structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python-files">2. Python files</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#simple-device-configurations">2.2.1 Simple Device Configurations</a></li>
<li class="toctree-l5"><a class="reference internal" href="#complex-device-configurations">2.2.2 Complex Device Configurations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#building-the-instrument-package">3. Building the Instrument Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#automated-build-and-upload">4. Automated Build and Upload</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-instrument-package">5. Install Instrument Package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pypi_upload.html">PyPI Upload</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../nomad_camels.html">nomad-camels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../genindex.html">Index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/FAU-LAP/NOMAD-CAMELS">Find us on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nomad-lab.eu/nomad-lab/">NOMAD Website</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.fairmat-nfdi.eu/fairmat">FAIRmat Website</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Imprint</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://www.lap.physik.nat.fau.de/impressum/">Imprint/Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_privacy.html">Data Privacy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NOMAD-CAMELS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="programmers_guide.html">Programmer’s Guide</a></li>
      <li class="breadcrumb-item active">Instrument Drivers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/doc/programmers_guide/instrument_drivers.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="instrument-drivers">
<h1>Instrument Drivers<a class="headerlink" href="#instrument-drivers" title="Permalink to this heading"></a></h1>
<p>This page should help you create new instrument drivers that can be used in NOMAD-CAMELS.</p>
<section id="local-instrument-drivers">
<h2>Local Instrument Drivers<a class="headerlink" href="#local-instrument-drivers" title="Permalink to this heading"></a></h2>
<p>You can create and use local instrument drivers by creating this kind of folder structure</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>nomad_camels_driver_&lt;parent_driver_name&gt; (contains the actual device communication files)
└─&gt; &lt;parent_driver_name&gt;.py
└─&gt; &lt;parent_driver_name&gt;_ophyd.py
</pre></div>
</div>
<p>and giving the path to the parent folder in the CAMELS settings.</p>
<p>CAMELS then searches the given path for folder starting with <code class="docutils literal notranslate"><span class="pre">nomad_camels_driver_</span></code> and extracts the device name from the text following this.<br />
For more details on how the .py and ophyd.py files should look like you can go to the code examples in <a class="reference internal" href="#python-files"><span class="std std-ref">Section 1.2.</span></a></p>
<section id="file-templates">
<h3>File Templates<a class="headerlink" href="#file-templates" title="Permalink to this heading"></a></h3>
<p>You can find templates for a new instrument driver <a class="reference external" href="https://github.com/FAU-LAP/CAMELS_drivers/tree/main/empty_instrument_driver">here</a>.</p>
<hr class="docutils" />
<section id="advanced-driver-information">
<h4>Advanced Driver Information<a class="headerlink" href="#advanced-driver-information" title="Permalink to this heading"></a></h4>
<p><strong>Regarding the <code class="docutils literal notranslate"><span class="pre">*.py</span></code> file.</strong></p>
<p>It should include a class <code class="docutils literal notranslate"><span class="pre">subclass</span></code> which inherits from <code class="docutils literal notranslate"><span class="pre">main_classes.device_class.Device</span></code>.
The arguments here should be set in the <strong>init</strong> by the subclass (following) the documentation of the Device class.
For most devices, nothing further should be necessary in this class.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">subclass_config</span></code>, inheriting from <code class="docutils literal notranslate"><span class="pre">main_classes.device_class.Device_Config</span></code> should provide the necessary configuration for the device and put this information into the device’s <code class="docutils literal notranslate"><span class="pre">config</span></code>, <code class="docutils literal notranslate"><span class="pre">settings</span></code> and <code class="docutils literal notranslate"><span class="pre">ioc_settings</span></code> attributes.</p>
<p><strong>Regarding the <code class="docutils literal notranslate"><span class="pre">*ophyd.py</span></code> file.</strong></p>
<p>This should include a class (meaningfully named) inheriting from <code class="docutils literal notranslate"><span class="pre">ophyd.Device</span></code>.
Here you may set all the components the device has. <br />
Components that are created with kind=’normal’ (or not specified) will appear as channels inside CAMELS. Channels can be set and read and are the main way CAMELS communicates with devices during measurements. <br />
Components with kind=’config’ should be part of the configuration-widget.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="writing-new-instrument-drivers-for-pypi">
<h2>Writing New Instrument Drivers for PyPi<a class="headerlink" href="#writing-new-instrument-drivers-for-pypi" title="Permalink to this heading"></a></h2>
<p>Every instrument driver should be an individual <a class="reference external" href="https://pypi.org/">PyPi</a> package.<br />
It is possible to create drivers that are only available locally for you.</p>
<blockquote>
<div><p>⚠
Currently the drivers are located in <a class="reference external" href="https://testPyPi.org/">testPyPi.org</a>. ⚠<br />
This will be changed to <a class="reference external" href="https://PyPi.org/">PyPi.org</a> once the devices are stable.</p>
</div></blockquote>
<p>The source code of each driver can be found in <a class="reference external" href="https://github.com/FAU-LAP/CAMELS_drivers">this repository</a>.</p>
<section id="folder-structure">
<h3>1. Folder structure<a class="headerlink" href="#folder-structure" title="Permalink to this heading"></a></h3>
<p>The driver should have the following folder structure</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;parent_driver_name&gt;
└─&gt; dist (this is automatically created by python -m build)
    └─&gt; nomad_camels_driver_&lt;parent_driver_name&gt;-X.Y.Z.tar.gz
    └─&gt; nomad_camels_driver_&lt;parent_driver_name&gt;-X.Y.Z-py3-none-any.whl
└─&gt; nomad_camels_driver_&lt;parent_driver_name&gt; (contains the actual device communication files)
    └─&gt; &lt;parent_driver_name&gt;.py
    └─&gt; &lt;parent_driver_name&gt;_ophyd.py
└─&gt; LICENSE.txt
└─&gt; pyproject.toml
└─&gt; README.md
</pre></div>
</div>
<p>The most important files are the <code class="docutils literal notranslate"><span class="pre">&lt;parent_driver_name&gt;.py</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;parent_driver_name&gt;_ophyd.py</span></code> files. The first one contains everything that is needed by the NOMAD-CAMELS GUI. The latter contains the class that is actually used for communicating with the device.<br />
The <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file contains most of the relevant information concerning the package that will be uploaded to PyPi (<a class="reference external" href="https://setuptools.pypa.io/en/latest/userguide/quickstart.html">see here for more information</a>).<br />
⚠ Most importantly the project name and version must be set in the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file.</p>
<hr class="docutils" />
<details>
  <summary>Code example: pyproject.toml file for the  Keithley 237</summary>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[build-system]</span>
<span class="n">requires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;setuptools&gt;=61.0&quot;</span><span class="p">]</span>
<span class="n">build-backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;setuptools.build_meta&quot;</span>

<span class="k">[project]</span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;nomad_camels_driver_keithley_237&quot;</span>
<span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0.1.4&quot;</span>
<span class="n">authors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="s">&quot;FAIRmat - HU Berlin&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="o">=</span><span class="s">&quot;nomad-camels@fau.de&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">]</span>
<span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Device driver for the Keithley 237 SMU.&quot;</span>
<span class="n">readme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;README.md&quot;</span>
<span class="n">requires-python</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&gt;=3.9.6&quot;</span>
<span class="n">classifiers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s">&quot;Programming Language :: Python :: 3&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;License :: OSI Approved :: GNU Lesser General Public License v2 (LGPLv2)&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Operating System :: Microsoft :: Windows&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s">&quot;pyvisa&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="k">[project.urls]</span>
<span class="s">&quot;GitHub Page&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://github.com/FAU-LAP/NOMAD-CAMELS&quot;</span>
<span class="s">&quot;Documentation&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;https://fau-lap.github.io/NOMAD-CAMELS/&quot;</span>
</pre></div>
</div>
</details>
<hr class="docutils" />
</section>
<section id="python-files">
<span id="id1"></span><h3>2. Python files<a class="headerlink" href="#python-files" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;parent_driver_name&gt;.py</span></code> file contains information about the possible instrument configurations and settings. This can be for example the current compliance of a voltage source or the integration time of a digital multimeter.</p>
<section id="simple-device-configurations">
<h4>2.2.1 Simple Device Configurations<a class="headerlink" href="#simple-device-configurations" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>⚠ For <strong>simple instruments</strong> with only a <strong>few settings</strong> you do not need to write your own GUI for the settings but CAMELS can auto-generate the UI for you. <br />
An example file is displayed below:</p>
</div></blockquote>
<hr class="docutils" />
<details>
  <summary>Code example: Use the auto-generated UI for instrument settings (for Keithley 237)</summary>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nomad_camels_driver_keithley_237.keithley_237_ophyd</span> <span class="kn">import</span> <span class="n">Keithley_237</span> <span class="c1"># Change this line!</span>
<span class="kn">from</span> <span class="nn">nomad_camels.main_classes</span> <span class="kn">import</span> <span class="n">device_class</span>

<span class="k">class</span> <span class="nc">subclass</span><span class="p">(</span><span class="n">device_class</span><span class="o">.</span><span class="n">Device</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># You can search for individual tags in the NOMAD-CAMELS GUI</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;keithley_237&#39;</span><span class="p">,</span> <span class="n">virtual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DMM&#39;</span><span class="p">,</span> <span class="s1">&#39;voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;current&#39;</span><span class="p">,],</span>       
                         <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;keithley_237&#39;</span><span class="p">,</span> <span class="n">ophyd_device</span><span class="o">=</span><span class="n">Keithley_237</span><span class="p">,</span> 
                         <span class="n">ophyd_class_name</span><span class="o">=</span><span class="s1">&#39;Keithley_237&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># These are the default values of the configuration settings  </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Four_wire&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Averages&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Integration_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;20ms&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Current_compliance_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Current_compliance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Voltage_compliance_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Voltage_compliance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Bias_delay&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Source_Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Voltage&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Sweep_Hysteresis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="sd">&quot;&quot;&quot;This adds a simple GUI of the configuration settings that you add below. </span>
<span class="sd">This way you do NOT need to write our own GUI for the instrument settings.</span>
<span class="sd">This can be used for simple instruments with only a few settings.</span>
<span class="sd">For more complicated instruments (with e.g. multiple channels) it might be necessary to write a more advanced GUI&quot;&quot;&quot;</span>
<span class="k">class</span> <span class="nc">subclass_config</span><span class="p">(</span><span class="n">device_class</span><span class="o">.</span><span class="n">Simple_Config</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">config_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ioc_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">additional_info</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Each dictionary entry become a combo box with the values ad drop down optins</span>
        <span class="n">comboBoxes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Source_Type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Voltage&quot;</span><span class="p">,</span> <span class="s2">&quot;Current&quot;</span><span class="p">,</span> <span class="s2">&quot;Sweep Voltage&quot;</span><span class="p">,</span> <span class="s2">&quot;Sweep Current&quot;</span><span class="p">],</span>
                      <span class="s1">&#39;Current_compliance_range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="s2">&quot;1nA&quot;</span><span class="p">,</span> <span class="s2">&quot;10nA&quot;</span><span class="p">,</span> <span class="s2">&quot;100nA&quot;</span><span class="p">,</span> <span class="s2">&quot;1uA&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;10uA&quot;</span><span class="p">,</span> <span class="s2">&quot;100uA&quot;</span><span class="p">,</span> <span class="s2">&quot;1mA&quot;</span><span class="p">,</span> <span class="s2">&quot;10mA&quot;</span><span class="p">,</span> <span class="s2">&quot;100mA&quot;</span><span class="p">],</span>
                      <span class="s1">&#39;Voltage_compliance_range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="s2">&quot;1.1V&quot;</span><span class="p">,</span> <span class="s2">&quot;11V&quot;</span><span class="p">,</span> <span class="s2">&quot;110V&quot;</span><span class="p">,</span> <span class="s2">&quot;1100V&quot;</span><span class="p">],</span>
                      <span class="s2">&quot;Averages&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;16&quot;</span><span class="p">,</span> <span class="s2">&quot;32&quot;</span><span class="p">],</span>
                      <span class="s1">&#39;Integration_time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;20ms&quot;</span><span class="p">,</span> <span class="s2">&quot;4ms&quot;</span><span class="p">,</span> <span class="s2">&quot;0.4ms&quot;</span><span class="p">],</span>
                      <span class="p">}</span>
        <span class="c1"># Creates text fields in to which the user can write. </span>
        <span class="c1"># It knows what type of field (bool, number, ...) it is from the default value above.</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Source_Type&#39;</span><span class="p">:</span> <span class="s1">&#39;Source type&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Current_compliance_range&#39;</span><span class="p">:</span> <span class="s1">&#39;Compliance range (A)&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Voltage_compliance_range&#39;</span><span class="p">:</span> <span class="s1">&#39;Compliance range (V)&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Integration_time&#39;</span><span class="p">:</span> <span class="s1">&#39;Integration time&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Four_wire&#39;</span><span class="p">:</span> <span class="s1">&#39;Four wire&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Current_compliance&#39;</span><span class="p">:</span> <span class="s1">&#39;Current compliance&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Voltage_compliance&#39;</span><span class="p">:</span> <span class="s1">&#39;Voltage compliance&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Bias_delay&#39;</span><span class="p">:</span> <span class="s1">&#39;Bias delay&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Sweep_Hysteresis&#39;</span><span class="p">:</span> <span class="s1">&#39;Sweep Hysteresis&#39;</span><span class="p">,</span>
                  <span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;Keithley 237&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">settings_dict</span><span class="p">,</span>
                         <span class="n">config_dict</span><span class="p">,</span> <span class="n">ioc_dict</span><span class="p">,</span> <span class="n">additional_info</span><span class="p">,</span> <span class="n">comboBoxes</span><span class="o">=</span><span class="n">comboBoxes</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_connection_type</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Local VISA&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_settings</span><span class="p">()</span>
</pre></div>
</div>
</details>
</section>
<hr class="docutils" />
<section id="complex-device-configurations">
<h4>2.2.2 Complex Device Configurations<a class="headerlink" href="#complex-device-configurations" title="Permalink to this heading"></a></h4>
<p>If the instrument is more complex CAMELS can not auto generate the UI anymore. Here you need to write your own UI using for example QT Designer. The first three class definitions are relevant for this.</p>
<hr class="docutils" />
<details>
  <summary>Code example: Use your own UI file to create settings for your instrument (for Andor Shamrock spectrograph)</summary>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">CAMELS.main_classes</span> <span class="kn">import</span> <span class="n">device_class</span>
<span class="kn">from</span> <span class="nn">.andor_shamrock_500_config</span> <span class="kn">import</span> <span class="n">Ui_andor_shamrock500_config</span>
<span class="kn">from</span> <span class="nn">.andor_shamrock_500_ophyd</span> <span class="kn">import</span> <span class="n">Andor_Shamrock_500</span>
<span class="kn">from</span> <span class="nn">PySide6.QtWidgets</span> <span class="kn">import</span> <span class="n">QTabWidget</span>


<span class="k">class</span> <span class="nc">subclass</span><span class="p">(</span><span class="n">device_class</span><span class="o">.</span><span class="n">Device</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;andor_shamrock_500&#39;</span><span class="p">,</span> <span class="n">virtual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">tags</span><span class="o">=</span><span class="p">[</span> <span class="s1">&#39;spectrometer&#39;</span><span class="p">,</span> <span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="s1">&#39;Andor&#39;</span><span class="p">,],</span>
                         <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;andor_shamrock_500&#39;</span><span class="p">,</span> <span class="n">ophyd_device</span><span class="o">=</span><span class="n">Andor_Shamrock_500</span><span class="p">,</span>
                         <span class="n">ophyd_class_name</span><span class="o">=</span><span class="s1">&#39;Andor_Shamrock_500&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">subclass_config</span><span class="p">(</span><span class="n">device_class</span><span class="o">.</span><span class="n">Device_Config</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">additional_info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;Andor Shamrock 500&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="n">settings_dict</span><span class="p">,</span> <span class="n">config_dict</span><span class="o">=</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">additional_info</span><span class="o">=</span><span class="n">additional_info</span><span class="p">,</span> <span class="n">no_ioc_connection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_connection_type</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Windows dll&#39;</span><span class="p">)</span>
        <span class="c1"># self.comboBox_connection_type.addItem(&#39;Local VISA&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>
        <span class="n">conf1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">):</span>
                <span class="n">conf1</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="c1"># !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
        <span class="c1"># Here you add your own UI as a tab widget. This is the key part !!!!!  </span>
        <span class="c1"># !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_1</span> <span class="o">=</span> <span class="n">subclass_config_sub</span><span class="p">(</span><span class="n">config_dict</span><span class="o">=</span><span class="n">conf1</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="n">settings_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_1</span><span class="p">,</span> <span class="s1">&#39;Settings&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_settings</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">conf1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_1</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">conf1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>

<span class="sd">&quot;&quot;&quot;This inherits from your UI and is used above to create the tab widget with all the settings you implemented.&quot;&quot;&quot;</span>
<span class="k">class</span> <span class="nc">subclass_config_sub</span><span class="p">(</span><span class="n">device_class</span><span class="o">.</span><span class="n">Device_Config_Sub</span><span class="p">,</span> <span class="n">Ui_andor_shamrock500_config</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">config_dict</span><span class="o">=</span><span class="n">config_dict</span><span class="p">,</span>
                         <span class="n">settings_dict</span><span class="o">=</span><span class="n">settings_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;set_grating_number&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_grating_number</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;set_grating_number&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;initial_wavelength&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_wavelength</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;initial_wavelength&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;input_port&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_port</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;input_port&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;output_port&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_port</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;output_port&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;select_camera&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_camera</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;select_camera&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;input_slit_size&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_slit_size</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;input_slit_size&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;output_slit_size&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_slit_size</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;output_slit_size&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;set_grating_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_grating_number</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;initial_wavelength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_wavelength</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;input_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_port</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;output_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_port</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;select_camera&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_camera</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;input_slit_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_slit_size</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;output_slit_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_slit_size</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
</pre></div>
</div>
</details>
<hr class="docutils" />
<p>Here is a more complex example which creates settings for two channels of a single instrument.</p>
<details>
  <summary>Code example: Two separate channels (for Keysight 2912)</summary>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nomad_camels.main_classes</span> <span class="kn">import</span> <span class="n">device_class</span>
<span class="kn">from</span> <span class="nn">keysight_b2912.keysight_b2912_channel_config</span> <span class="kn">import</span> <span class="n">Ui_B2912_channel</span> <span class="c1"># You need to import the created UI file</span>
<span class="kn">from</span> <span class="nn">keysight_b2912.keysight_b2912_ophyd</span> <span class="kn">import</span> <span class="n">Keysight_B2912</span> <span class="c1"># Import the actual device communication</span>
<span class="kn">from</span> <span class="nn">PySide6.QtWidgets</span> <span class="kn">import</span> <span class="n">QTabWidget</span>

<span class="sd">&quot;&quot;&quot;Default settings of the instrument&quot;&quot;&quot;</span>
<span class="n">default_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;Voltage&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;source_range&#39;</span><span class="p">:</span> <span class="s1">&#39;2E-1 V&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;range_lower_lim&#39;</span><span class="p">:</span> <span class="s1">&#39;2E-1 V&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;source_auto&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;low_terminal&#39;</span><span class="p">:</span> <span class="s1">&#39;Ground&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;current_auto_mode&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;current_lower_lim&#39;</span><span class="p">:</span> <span class="s1">&#39;1E-8 A&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;current_range&#39;</span><span class="p">:</span> <span class="s1">&#39;1E-8 A&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;voltage_range&#39;</span><span class="p">:</span> <span class="s1">&#39;2E-1 V&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;voltage_auto_mode&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;voltage_lower_lim&#39;</span><span class="p">:</span> <span class="s1">&#39;2E-1 V&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;resistance_range&#39;</span><span class="p">:</span> <span class="s1">&#39;2 Ohm&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;resistance_upper_lim&#39;</span><span class="p">:</span> <span class="s1">&#39;200E6 Ohm&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;output_protection&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;four_wire_meas&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;current_auto_range&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;voltage_auto_range&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;resistance_auto_range&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;resistance_compensation&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;voltage_compliance&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s1">&#39;current_compliance&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s1">&#39;NPLC&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="sd">&quot;&quot;&quot;Similar to the simple device&quot;&quot;&quot;</span>
<span class="k">class</span> <span class="nc">subclass</span><span class="p">(</span><span class="n">device_class</span><span class="o">.</span><span class="n">Device</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;keysight_b2912&#39;</span><span class="p">,</span> <span class="n">virtual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SMU&#39;</span><span class="p">,</span> <span class="s1">&#39;voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;current&#39;</span><span class="p">,</span> <span class="s1">&#39;resistance&#39;</span><span class="p">],</span> <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;keysight_b2912&#39;</span><span class="p">,</span> <span class="n">ophyd_device</span><span class="o">=</span><span class="n">Keysight_B2912</span><span class="p">,</span> <span class="n">ophyd_class_name</span><span class="o">=</span><span class="s1">&#39;Keysight_B2912&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># This sets the default settings for each channel</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">default_settings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

<span class="k">class</span> <span class="nc">subclass_config</span><span class="p">(</span><span class="n">device_class</span><span class="o">.</span><span class="n">Device_Config</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">additional_info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;Keysight B2912&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="n">settings_dict</span><span class="p">,</span> <span class="n">config_dict</span><span class="o">=</span><span class="n">config_dict</span><span class="p">,</span> <span class="n">additional_info</span><span class="o">=</span><span class="n">additional_info</span><span class="p">,</span> <span class="n">no_ioc_connection</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_connection_type</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Local VISA&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">()</span>
        <span class="n">conf1</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">conf2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">):</span>
                <span class="n">conf1</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">elif</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">):</span>
                <span class="n">conf2</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="c1"># !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
        <span class="c1"># Here you add your own UI as a tab widget. This is the key part !!!!!  </span>
        <span class="c1"># !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_1</span> <span class="o">=</span> <span class="n">subclass_config_sub</span><span class="p">(</span><span class="n">config_dict</span><span class="o">=</span><span class="n">conf1</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="n">settings_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_2</span> <span class="o">=</span> <span class="n">subclass_config_sub</span><span class="p">(</span><span class="n">config_dict</span><span class="o">=</span><span class="n">conf2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="n">settings_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_1</span><span class="p">,</span> <span class="s1">&#39;Channel 1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_2</span><span class="p">,</span> <span class="s1">&#39;Channel 2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_settings</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">conf1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_1</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
        <span class="n">conf2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel_widge_2</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">conf1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">conf2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>

<span class="sd">&quot;&quot;&quot;This inherits from the UI class you wrote for the UI config settings of the instrument&quot;&quot;&quot;</span>
<span class="k">class</span> <span class="nc">subclass_config_sub</span><span class="p">(</span><span class="n">device_class</span><span class="o">.</span><span class="n">Device_Config_Sub</span><span class="p">,</span> <span class="n">Ui_B2912_channel</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">settings_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">config_dict</span><span class="o">=</span><span class="n">config_dict</span><span class="p">,</span>
                         <span class="n">settings_dict</span><span class="o">=</span><span class="n">settings_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;Current&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;source&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span> <span class="ow">and</span> <span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">low_terminals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ground&#39;</span><span class="p">,</span> <span class="s1">&#39;Float&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_low_terminal</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">low_terminals</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;low_terminal&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span> <span class="ow">and</span> <span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;low_terminal&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_terminals</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_low_terminal</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2E-1 V&#39;</span><span class="p">,</span> <span class="s1">&#39;2 V&#39;</span><span class="p">,</span> <span class="s1">&#39;20 V&#39;</span><span class="p">,</span> <span class="s1">&#39;200 V&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1E-8 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1E-7 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1E-6 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1E-5 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1E-4 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1E-3 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1E-2 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1E-1 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1 A&#39;</span><span class="p">,</span> <span class="s1">&#39;1.5 A&#39;</span><span class="p">,</span> <span class="s1">&#39;3 A&#39;</span><span class="p">,</span> <span class="s1">&#39;10 A&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ranges_resistance</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2 Ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;20 Ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;200 Ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;2E3 Ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;20E3 Ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;200E3 Ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;2E6 Ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;20E6 Ohm&#39;</span><span class="p">,</span> <span class="s1">&#39;200E6 Ohm&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;source_auto&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_source_auto</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source_auto&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_source_auto</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_source_options</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_source_auto</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_source_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_source_options</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;output_protection&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_output_protection</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;output_protection&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;current_compliance&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_current_compliance</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_compliance&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_current_compliance</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;0.1&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;voltage_compliance&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_voltage_compliance</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_compliance&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_voltage_compliance</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;NPLC&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_NPLC</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;NPLC&#39;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_NPLC</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;four_wire_meas&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_four_wire_meas</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;four_wire_meas&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;current_auto_range&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_current_auto_range</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_auto_range&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;voltage_auto_range&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_voltage_auto_range</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_auto_range&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;resistance_auto_range&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_resistance_auto_range</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_auto_range&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;resistance_compensation&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_resistance_compensation</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_compensation&#39;</span><span class="p">])</span>

        <span class="n">auto_range_modes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Normal&#39;</span><span class="p">,</span> <span class="s1">&#39;Resolution&#39;</span><span class="p">,</span> <span class="s1">&#39;Speed&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_auto_mode</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">auto_range_modes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_auto_mode</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">auto_range_modes</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;voltage_auto_mode&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span> <span class="ow">and</span> <span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_auto_mode&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">auto_range_modes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_auto_mode</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_auto_mode&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;current_auto_mode&#39;</span> <span class="ow">in</span> <span class="n">config_dict</span> <span class="ow">and</span> <span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_auto_mode&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">auto_range_modes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_auto_mode</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_auto_mode&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_lower_lim</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;current_lower_lim&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_lower_lim&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_lower_lim</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_lower_lim&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_range</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;current_range&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_range&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_range</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_range&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_lower_lim</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;voltage_lower_lim&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_lower_lim&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_lower_lim</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_lower_lim&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_range</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;voltage_range&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_range&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_range</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_range&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_resistance_range</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_resistance</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;resistance_range&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_range&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_resistance</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_resistance_range</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_range&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_resistance_upper_lim</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_resistance</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;resistance_upper_lim&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_upper_lim&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_resistance</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_resistance_upper_lim</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_upper_lim&#39;</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">load_source_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">src_v</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Current&#39;</span><span class="p">:</span>
            <span class="n">src_v</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">auto_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_source_auto</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source_range</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_range_lower_lim</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">src_v</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source_range</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_range_lower_lim</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;source_range&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source_range&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source_range</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source_range&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;range_lower_lim&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;range_lower_lim&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_voltage</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_range_lower_lim</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;range_lower_lim&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source_range</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_range_lower_lim</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;source_range&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source_range&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source_range</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source_range&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;range_lower_lim&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;range_lower_lim&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ranges_current</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_range_lower_lim</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;range_lower_lim&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source_range</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="ow">not</span> <span class="n">auto_source</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_range_lower_lim</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">auto_source</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;low_terminal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_low_terminal</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_source_range</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;range_lower_lim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_range_lower_lim</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_auto_mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_auto_mode</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_lower_lim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_lower_lim</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_current_range</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_range</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_auto_mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_auto_mode</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_lower_lim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_voltage_lower_lim</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_resistance_range</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_upper_lim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_resistance_upper_lim</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;source_auto&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_source_auto</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;output_protection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_output_protection</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;four_wire_meas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_four_wire_meas</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_auto_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_current_auto_range</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_auto_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_voltage_auto_range</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_auto_range&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_resistance_auto_range</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;resistance_compensation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_resistance_compensation</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;current_compliance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_current_compliance</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;voltage_compliance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_voltage_compliance</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_dict</span><span class="p">[</span><span class="s1">&#39;NPLC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_NPLC</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>

</pre></div>
</div>
</details>
</section>
</section>
<hr class="docutils" />
<section id="building-the-instrument-package">
<h3>3. Building the Instrument Package<a class="headerlink" href="#building-the-instrument-package" title="Permalink to this heading"></a></h3>
<p>To create a new package that can be installed via pip from PyPi or testPyPi follow these steps.</p>
<ol class="arabic">
<li><p>Make sure you have <code class="docutils literal notranslate"><span class="pre">build</span></code> and <code class="docutils literal notranslate"><span class="pre">twine</span></code> installed into your python environment with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">build</span></code> and <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">twine</span></code></p></li>
<li><p>Go to the <code class="docutils literal notranslate"><span class="pre">&lt;parent_driver_name&gt;</span></code> directory of the driver. So the parent directory containing the pyproject.toml</p></li>
<li><p>Set the correct version number and metadata in your <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file</p></li>
<li><p>Run the build command : <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">build</span></code>. This creates the <code class="docutils literal notranslate"><span class="pre">dist/</span></code> folder and the distributions to upload to PyPi</p></li>
<li><p>Upload to testPyPi (PyPi) with</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python -m twine upload --repository testpypi dist/nomad*</span>
</pre></div>
</div>
<p>⚠ Change the repository used after the <code class="docutils literal notranslate"><span class="pre">--repository</span></code> flag to <code class="docutils literal notranslate"><span class="pre">pypi</span></code> to upload to PyPi</p>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="automated-build-and-upload">
<h3>4. Automated Build and Upload<a class="headerlink" href="#automated-build-and-upload" title="Permalink to this heading"></a></h3>
<p>You can run the following script using microsoft PowerShell in the <code class="docutils literal notranslate"><span class="pre">$rootFolder</span></code> containing multiple instrument drivers in subdirectories.<br />
It runs the <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">build</span></code> and <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">twine</span> <span class="pre">upload</span> <span class="pre">-r</span> <span class="pre">testpypi</span> <span class="pre">dist/nomad*</span></code> commands in each subdirectory containing a <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$rootFolder</span> <span class="p">=</span> <span class="s2">&quot;C:\Path\To\Root\Folder&quot;</span>
<span class="nb">Get-ChildItem</span> <span class="nv">$rootFolder</span> <span class="n">-Recurse</span> <span class="n">-Directory</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="s2">&quot;</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span><span class="p">)</span><span class="s2">\pyproject.toml&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Push-Location</span> <span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span>
        <span class="n">python</span> <span class="n">-m</span> <span class="n">build</span>
        <span class="n">python</span> <span class="n">-m</span> <span class="n">twine</span> <span class="n">upload</span> <span class="n">-r</span> <span class="n">testpypi</span> <span class="n">dist</span><span class="p">/</span><span class="n">nomad</span><span class="p">*</span>
        <span class="nb">Pop-Location</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="install-instrument-package">
<h3>5. Install Instrument Package<a class="headerlink" href="#install-instrument-package" title="Permalink to this heading"></a></h3>
<p>To install  run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install --no-cache-dir --index-url https://test.pypi.org/simple/ --extra-index-url https://pypi.org/simple nomad_camels_driver_&lt;parent_driver_name&gt;</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">nomad_camels_driver_&lt;parent_driver_name&gt;</span></code> is the driver name you gave your folder and project.<br />
The <code class="docutils literal notranslate"><span class="pre">--extra-index-url</span></code> flag allows dependencies to be installed from PyPi.<br />
The <code class="docutils literal notranslate"><span class="pre">--no-cache-dir</span></code> flag prevents any locally saved NOMAD-CAMELS version to be installed instead of the most recent remote version.\</p>
<blockquote>
<div><p>⚠ The index-url must be changed of course when installing from PyPi ⚠</p>
</div></blockquote>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="camels_installer.html" class="btn btn-neutral float-left" title="Changing the CAMELS Installer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pypi_upload.html" class="btn btn-neutral float-right" title="Uploading a new NOMAD-CAMELS version to PyPI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, FAIRmat.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
<br><br>
<a href="https://www.lap.physik.nat.fau.de/impressum/">Imprint</a><br>
<a href="data_privacy.html">Data privacy statement</a>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>